

Sub initega() 
        Dim As Integer c,d,e 
        
        'bpp=8 
        '
        'For c=0 To 255
        '  e=c 
        '  for d=0 To 7
        '     rotatevga(d, c)=e 
        '     e=(e Shr 1) Or IIf((e And 1),&h80,0) 
        '  Next
        'Next
        
        crtc(&hC)=0
        crtc(&hD)=0 

        'incga=0

        for c=0 To 3
          for d=0 To 3
               edatlookup(c, d)=0 
               if (c And 1) Then edatlookup(c, d) Or= 1 
               if (d And 1) Then edatlookup(c, d) Or= 2 
               if (c And 2) Then edatlookup(c, d) Or= &h10 
               if (d And 2) Then edatlookup(c, d) Or= &h20 
          Next
        Next
        
        ' esta paleta de 16 y 64 colores, solo la emplea el modulo EGA, el VGA emplea la de 256 (pallook256())
        'for  c=0 To 255
        '        pallook64(c) =makecol32(((c Shr 2) And 1)*&hAA,((c Shr 1) And 1)*&hAA, (c And 1)*&hAA) 
        '        pallook64(c)+=makecol32(((c Shr 5) And 1)*&h55,((c Shr 4) And 1)*&h55,((c Shr 3) And 1)*&h55) 
        '        pallook16(c) =makecol32(((c Shr 2) And 1)*&hAA,((c Shr 1) And 1)*&hAA, (c And 1)*&hAA) 
        '        pallook16(c)+=makecol32(((c Shr 4) And 1)*&h55,((c Shr 4) And 1)*&h55,((c Shr 4) And 1)*&h55) 
        '        if ((c And &h17)=6) Then pallook16(c)=makecol32(&hAA,&h55,0) 
        'Next
        'pallook=@pallook16(0) ' puntero al color generado antes
        

        
        seqregs(&hC)=&h20 
        'vrammask=&hFFFFF ' para la ET4000 (nota, se define en et4000_init segun el tamaño de la VRAM)
        gdcreg(6)=8 
        gdcreg(8)=&hFF 
        writemode=0 
        chain4=0 
        writemask=3 
        svgarbank=0
        svgawbank=0 
        
        
' paleta VGA "inventada" (del modulo "viejo" del 8086 FB)
    ' puntero a la paleta
    pallook=@pallook256(0)

' la paleta solo es util para ROMS (BIOS) que no la generan automatico, como el TEST.BIN
' se puede borrar cuando todo funcione
    pallook256(0) = rgb(0, 0, 0)
    pallook256(1) = rgb(0, 0, 169)
    pallook256(2) = rgb(0, 169, 0)
    pallook256(3) = rgb(0, 169, 169)
    pallook256(4) = rgb(169, 0, 0)
    pallook256(5) = rgb(169, 0, 169)
    pallook256(6) = rgb(169, 169, 0)
    pallook256(7) = rgb(169, 169, 169)
    pallook256(8) = rgb(0, 0, 84)
    pallook256(9) = rgb(0, 0, &hFF)
    pallook256(10) = rgb(0, 169, 84)
    pallook256(11) = rgb(0, 169, &hFF)
    pallook256(12) = rgb(169, 0, 84)
    pallook256(13) = rgb(169, 0, &hFF)
    pallook256(14) = rgb(169, 169, 84)
    pallook256(15) = rgb(169, 169, &hFF)
    pallook256(16) = rgb(0, 84, 0)
    pallook256(17) = rgb(0, 84, 169)
    pallook256(18) = rgb(0, &hFF, 0)
    pallook256(19) = rgb(0, &hFF, 169)
    pallook256(20) = rgb(169, 84, 0)
    pallook256(21) = rgb(169, 84, 169)
    pallook256(22) = rgb(169, &hFF, 0)
    pallook256(23) = rgb(169, &hFF, 169)
    pallook256(24) = rgb(0, 84, 84)
    pallook256(25) = rgb(0, 84, &hFF)
    pallook256(26) = rgb(0, &hFF, 84)
    pallook256(27) = rgb(0, &hFF, &hFF)
    pallook256(28) = rgb(169, 84, 84)
    pallook256(29) = rgb(169, 84, &hFF)
    pallook256(30) = rgb(169, &hFF, 84)
    pallook256(31) = rgb(169, &hFF, &hFF)
    pallook256(32) = rgb(84, 0, 0)
    pallook256(33) = rgb(84, 0, 169)
    pallook256(34) = rgb(84, 169, 0)
    pallook256(35) = rgb(84, 169, 169)
    pallook256(36) = rgb(&hFF, 0, 0)
    pallook256(37) = rgb(&hFF, 0, 169)
    pallook256(38) = rgb(&hFF, 169, 0)
    pallook256(39) = rgb(&hFF, 169, 169)
    pallook256(40) = rgb(84, 0, 84)
    pallook256(41) = rgb(84, 0, &hFF)
    pallook256(42) = rgb(84, 169, 84)
    pallook256(43) = rgb(84, 169, &hFF)
    pallook256(44) = rgb(&hFF, 0, 84)
    pallook256(45) = rgb(&hFF, 0, &hFF)
    pallook256(46) = rgb(&hFF, 169, 84)
    pallook256(47) = rgb(&hFF, 169, &hFF)
    pallook256(48) = rgb(84, 84, 0)
    pallook256(49) = rgb(84, 84, 169)
    pallook256(50) = rgb(84, &hFF, 0)
    pallook256(51) = rgb(84, &hFF, 169)
    pallook256(52) = rgb(&hFF, 84, 0)
    pallook256(53) = rgb(&hFF, 84, 169)
    pallook256(54) = rgb(&hFF, &hFF, 0)
    pallook256(55) = rgb(&hFF, &hFF, 169)
    pallook256(56) = rgb(84, 84, 84)
    pallook256(57) = rgb(84, 84, &hFF)
    pallook256(58) = rgb(84, &hFF, 84)
    pallook256(59) = rgb(84, &hFF, &hFF)
    pallook256(60) = rgb(&hFF, 84, 84)
    pallook256(61) = rgb(&hFF, 84, &hFF)
    pallook256(62) = rgb(&hFF, &hFF, 84)
    pallook256(63) = rgb(&hFF, &hFF, &hFF)
    pallook256(64) = rgb(&hFF, 125, 125)
    pallook256(65) = rgb(&hFF, 157, 125)
    pallook256(66) = rgb(&hFF, 190, 125)
    pallook256(67) = rgb(&hFF, 222, 125)
    pallook256(68) = rgb(&hFF, &hFF, 125)
    pallook256(69) = rgb(222, &hFF, 125)
    pallook256(70) = rgb(190, &hFF, 125)
    pallook256(71) = rgb(157, &hFF, 125)
    pallook256(72) = rgb(125, &hFF, 125)
    pallook256(73) = rgb(125, &hFF, 157)
    pallook256(74) = rgb(125, &hFF, 190)
    pallook256(75) = rgb(125, &hFF, 222)
    pallook256(76) = rgb(125, &hFF, &hFF)
    pallook256(77) = rgb(125, 222, &hFF)
    pallook256(78) = rgb(125, 190, &hFF)
    pallook256(79) = rgb(125, 157, &hFF)
    pallook256(80) = rgb(182, 182, &hFF)
    pallook256(81) = rgb(198, 182, &hFF)
    pallook256(82) = rgb(218, 182, &hFF)
    pallook256(83) = rgb(234, 182, &hFF)
    pallook256(84) = rgb(&hFF, 182, &hFF)
    pallook256(85) = rgb(&hFF, 182, 234)
    pallook256(86) = rgb(&hFF, 182, 218)
    pallook256(87) = rgb(&hFF, 182, 198)
    pallook256(88) = rgb(&hFF, 182, 182)
    pallook256(89) = rgb(&hFF, 198, 182)
    pallook256(90) = rgb(&hFF, 218, 182)
    pallook256(91) = rgb(&hFF, 234, 182)
    pallook256(92) = rgb(&hFF, &hFF, 182)
    pallook256(93) = rgb(234, &hFF, 182)
    pallook256(94) = rgb(218, &hFF, 182)
    pallook256(95) = rgb(198, &hFF, 182)
    pallook256(96) = rgb(182, &hFF, 182)
    pallook256(97) = rgb(182, &hFF, 198)
    pallook256(98) = rgb(182, &hFF, 218)
    pallook256(99) = rgb(182, &hFF, 234)
    pallook256(100) = rgb(182, &hFF, &hFF)
    pallook256(101) = rgb(182, 234, &hFF)
    pallook256(102) = rgb(182, 218, &hFF)
    pallook256(103) = rgb(182, 198, &hFF)
    pallook256(104) = rgb(0, 0, 113)
    pallook256(105) = rgb(28, 0, 113)
    pallook256(106) = rgb(56, 0, 113)
    pallook256(107) = rgb(84, 0, 113)
    pallook256(108) = rgb(113, 0, 113)
    pallook256(109) = rgb(113, 0, 84)
    pallook256(110) = rgb(113, 0, 56)
    pallook256(111) = rgb(113, 0, 28)
    pallook256(112) = rgb(113, 0, 0)
    pallook256(113) = rgb(113, 28, 0)
    pallook256(114) = rgb(113, 56, 0)
    pallook256(115) = rgb(113, 84, 0)
    pallook256(116) = rgb(113, 113, 0)
    pallook256(117) = rgb(84, 113, 0)
    pallook256(118) = rgb(56, 113, 0)
    pallook256(119) = rgb(28, 113, 0)
    pallook256(120) = rgb(0, 113, 0)
    pallook256(121) = rgb(0, 113, 28)
    pallook256(122) = rgb(0, 113, 56)
    pallook256(123) = rgb(0, 113, 84)
    pallook256(124) = rgb(0, 113, 113)
    pallook256(125) = rgb(0, 84, 113)
    pallook256(126) = rgb(0, 56, 113)
    pallook256(127) = rgb(0, 28, 113)
    pallook256(128) = rgb(56, 56, 113)
    pallook256(129) = rgb(68, 56, 113)
    pallook256(130) = rgb(84, 56, 113)
    pallook256(131) = rgb(97, 56, 113)
    pallook256(132) = rgb(113, 56, 113)
    pallook256(133) = rgb(113, 56, 97)
    pallook256(134) = rgb(113, 56, 84)
    pallook256(135) = rgb(113, 56, 68)
    pallook256(136) = rgb(113, 56, 56)
    pallook256(137) = rgb(113, 68, 56)
    pallook256(138) = rgb(113, 84, 56)
    pallook256(139) = rgb(113, 97, 56)
    pallook256(140) = rgb(113, 113, 56)
    pallook256(141) = rgb(97, 113, 56)
    pallook256(142) = rgb(84, 113, 56)
    pallook256(143) = rgb(68, 113, 56)
    pallook256(144) = rgb(56, 113, 56)
    pallook256(145) = rgb(56, 113, 68)
    pallook256(146) = rgb(56, 113, 84)
    pallook256(147) = rgb(56, 113, 97)
    pallook256(148) = rgb(56, 113, 113)
    pallook256(149) = rgb(56, 97, 113)
    pallook256(150) = rgb(56, 84, 113)
    pallook256(151) = rgb(56, 68, 113)
    pallook256(152) = rgb(80, 80, 113)
    pallook256(153) = rgb(89, 80, 113)
    pallook256(154) = rgb(97, 80, 113)
    pallook256(155) = rgb(105, 80, 113)
    pallook256(156) = rgb(113, 80, 113)
    pallook256(157) = rgb(113, 80, 105)
    pallook256(158) = rgb(113, 80, 97)
    pallook256(159) = rgb(113, 80, 89)
    pallook256(160) = rgb(113, 80, 80)
    pallook256(161) = rgb(113, 89, 80)
    pallook256(162) = rgb(113, 97, 80)
    pallook256(163) = rgb(113, 105, 80)
    pallook256(164) = rgb(113, 113, 80)
    pallook256(165) = rgb(105, 113, 80)
    pallook256(166) = rgb(97, 113, 80)
    pallook256(167) = rgb(89, 113, 80)
    pallook256(168) = rgb(80, 113, 80)
    pallook256(169) = rgb(80, 113, 89)
    pallook256(170) = rgb(80, 113, 97)
    pallook256(171) = rgb(80, 113, 105)
    pallook256(172) = rgb(80, 113, 113)
    pallook256(173) = rgb(80, 105, 113)
    pallook256(174) = rgb(80, 97, 113)
    pallook256(175) = rgb(80, 89, 113)
    pallook256(176) = rgb(0, 0, 64)
    pallook256(177) = rgb(16, 0, 64)
    pallook256(178) = rgb(32, 0, 64)
    pallook256(179) = rgb(48, 0, 64)
    pallook256(180) = rgb(64, 0, 64)
    pallook256(181) = rgb(64, 0, 48)
    pallook256(182) = rgb(64, 0, 32)
    pallook256(183) = rgb(64, 0, 16)
    pallook256(184) = rgb(64, 0, 0)
    pallook256(185) = rgb(64, 16, 0)
    pallook256(186) = rgb(64, 32, 0)
    pallook256(187) = rgb(64, 48, 0)
    pallook256(188) = rgb(64, 64, 0)
    pallook256(189) = rgb(48, 64, 0)
    pallook256(190) = rgb(32, 64, 0)
    pallook256(191) = rgb(16, 64, 0)
    pallook256(192) = rgb(0, 64, 0)
    pallook256(193) = rgb(0, 64, 16)
    pallook256(194) = rgb(0, 64, 32)
    pallook256(195) = rgb(0, 64, 48)
    pallook256(196) = rgb(0, 64, 64)
    pallook256(197) = rgb(0, 48, 64)
    pallook256(198) = rgb(0, 32, 64)
    pallook256(199) = rgb(0, 16, 64)
    pallook256(200) = rgb(32, 32, 64)
    pallook256(201) = rgb(40, 32, 64)
    pallook256(202) = rgb(48, 32, 64)
    pallook256(203) = rgb(56, 32, 64)
    pallook256(204) = rgb(64, 32, 64)
    pallook256(205) = rgb(64, 32, 56)
    pallook256(206) = rgb(64, 32, 48)
    pallook256(207) = rgb(64, 32, 40)
    pallook256(208) = rgb(64, 32, 32)
    pallook256(209) = rgb(64, 40, 32)
    pallook256(210) = rgb(64, 48, 32)
    pallook256(211) = rgb(64, 56, 32)
    pallook256(212) = rgb(64, 64, 32)
    pallook256(213) = rgb(56, 64, 32)
    pallook256(214) = rgb(48, 64, 32)
    pallook256(215) = rgb(40, 64, 32)
    pallook256(216) = rgb(32, 64, 32)
    pallook256(217) = rgb(32, 64, 40)
    pallook256(218) = rgb(32, 64, 48)
    pallook256(219) = rgb(32, 64, 56)
    pallook256(220) = rgb(32, 64, 64)
    pallook256(221) = rgb(32, 56, 64)
    pallook256(222) = rgb(32, 48, 64)
    pallook256(223) = rgb(32, 40, 64)
    pallook256(224) = rgb(44, 44, 64)
    pallook256(225) = rgb(48, 44, 64)
    pallook256(226) = rgb(52, 44, 64)
    pallook256(227) = rgb(60, 44, 64)
    pallook256(228) = rgb(64, 44, 64)
    pallook256(229) = rgb(64, 44, 60)
    pallook256(230) = rgb(64, 44, 52)
    pallook256(231) = rgb(64, 44, 48)
    pallook256(232) = rgb(64, 44, 44)
    pallook256(233) = rgb(64, 48, 44)
    pallook256(234) = rgb(64, 52, 44)
    pallook256(235) = rgb(64, 60, 44)
    pallook256(236) = rgb(64, 64, 44)
    pallook256(237) = rgb(60, 64, 44)
    pallook256(238) = rgb(52, 64, 44)
    pallook256(239) = rgb(48, 64, 44)
    pallook256(240) = rgb(44, 64, 44)
    pallook256(241) = rgb(44, 64, 48)
    pallook256(242) = rgb(44, 64, 52)
    pallook256(243) = rgb(44, 64, 60)
    pallook256(244) = rgb(44, 64, 64)
    pallook256(245) = rgb(44, 60, 64)
    pallook256(246) = rgb(44, 52, 64)
    pallook256(247) = rgb(44, 48, 64)
    pallook256(248) = rgb(0, 0, 0)
    pallook256(249) = rgb(0, 0, 0)
    pallook256(250) = rgb(0, 0, 0)
    pallook256(251) = rgb(0, 0, 0)
    pallook256(252) = rgb(0, 0, 0)
    pallook256(253) = rgb(0, 0, 0)
    pallook256(254) = rgb(0, 0, 0)
    pallook256(255) = rgb(0, 0, 0)
        
        
        
End Sub

